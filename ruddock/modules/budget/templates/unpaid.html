{% extends "layout.html" %}

{% import "forms.html" as forms %}

{% block head %}

{% endblock head %}

{% block body %}

<h2>Unpaid Expenses</h2>
<hr>
No client side validation for now. If you submit an invalid request, you'll have to start again.
<hr>
{% if unpaid_expenses %}
{% for payee_id, payee_name, total, expenses in unpaid_expenses %}
<h3>{{ payee_name }}: ${{ total }}</h3>
<form action="{{ url_for('budget.route_submit_unpaid') }}" method="POST">
  <!-- hidden input tags so that POST sends this -->
  <input type="hidden" id="payee-id" name="payee-id" value="{{ payee_id }}">
  <input type="hidden" name="total" value="{{ total }}">
  <!-- visible stuff -->
  {{ forms.payment(payment_types, accounts) }}
  <br>
  <label for="date-written">Date Written:</label>
  <input type="date" id="date-written" name="date-written">
  <br>
  <label for="expense-list">Expenses:</label>
  <table id="expense-list">

    <thead>
      <tr>
        <th>Budget</th>
        <th>FY</th>
        <th>Date Incurred</th>
        <th>Description</th>
        <th>Amount</th>
      </tr>
    </thead>

    <tbody>
      {% for r in expenses %}
      <tr>
        <td>{{ r["budget_name"] }}</td>
        <td>{{ r["fyear_num"] }}</td>
        <td>{{ r["date_incurred"] }}</td>
        <td>{{ r["description"].decode("utf8") }}</td>
        <td>{{ r["cost"] }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  <input type="submit" value="Record Payment">
</form>
<hr>
{% endfor %}
{% else %}
<h3>All expenses have been paid!</h3>
{% endif %}

{% endblock body %}